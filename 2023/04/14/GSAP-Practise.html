

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" href="/img/favicon.ico">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="　　在上一篇文章中，我们对GSAP的用法有了一个简单的了解，本文我们就结合GSAP的用法教程，仿照荣耀官网MagicOS的页面，实现一个酷炫的网页效果。">
  <meta name="author" content="Corner">
  <meta name="keywords" content="Corner">
  
  <title>GSAP实战仿荣耀官网的页面滚动效果 - 谢小飞的博客</title>

  <link  rel="stylesheet" href="https://xieyufei.com/npm/bootstrap/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://xieyufei.com/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://xieyufei.com/npm/highlight.js@10.7.2/styles/vs2015.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://xieyufei.com/npm/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"xieyufei.com","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"466240fe55764d8ee20bd7f43c5e8b26","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":1260607518,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/title.js" ></script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="谢小飞的博客" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>谢小飞的博客</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-pen"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-friends"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://gallery.xieyufei.com/">
                <i class="iconfont icon-link-fill"></i>
                创意
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bookshelf/">
                <i class="iconfont icon-books"></i>
                书架
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('//xieyufei.com/blog/bg_small.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="GSAP实战仿荣耀官网的页面滚动效果">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-04-14 20:00" pubdate>
        2023年4月14日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      5k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      66
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      
<style>
  .prevent_reptile{
    display: none;
  }
</style>
<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">GSAP实战仿荣耀官网的页面滚动效果</h1>
            
            <div class="markdown-body">
              <p>　　在<a href="https://xieyufei.com/2023/02/06/GSAP-Learn.html">上一篇文章</a>中，我们对GSAP的用法有了一个简单的了解，本文我们就结合GSAP的用法教程，仿照荣耀官网MagicOS的页面，实现一个酷炫的网页效果。</p>
<span id="more"></span>



<h1 id="整体样式布局"><a href="#整体样式布局" class="headerlink" title="整体样式布局"></a>整体样式布局</h1><p>　　我们先来欣赏一下页面的效果，每一幕如同电影开场一样缓缓的呈现效果，大家可以点击<a target="_blank" rel="noopener" href="https://gallery.xieyufei.com/case/gsap/honor">这个链接</a>来欣赏效果：</p>
<p><img src="/images/GSAP-Practise/demo.gif" srcset="/img/loading.gif" lazyload alt="整体效果"></p>
<p>　　在整体布局上，我们发现，它是通过多个section来划分每一屏的；这里的一屏，可以理解为一个动画效果的划分，每一屏的高度大致等于100vh。</p>
<p>　　大多数的section再嵌套一层<code>.section-wrapper</code>来包裹内部的元素，同时使用<code>margin: 0 auto;</code>来让wrapper左右居中：</p>
<figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main magic-os&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 第一屏 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-hero section-dark&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-wrapper&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 第三屏 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-magic&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-wrapper&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 省略其他屏... --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></div></td></tr></table></figure>


<p>　　样式上，将很多屏公共的、通用样式抽离出来，放到<code>.magic-os</code>中，比如给section添加黑色的背景<code>.section-dark</code>，<code>.section-headline</code>是主标题，<code>.section-intro</code>是介绍性的文字，<code>.section-link</code>是跳转链接等等；不同屏有相同的布局和呈现效果，样式上也可以通用，比如<code>.section-start</code>呈现svg画图和<code>.section-card-view</code>呈现卡片式布局等等。</p>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss"><span class="hljs-selector-class">.magic-os</span> &#123;<br>  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;<br>  <span class="hljs-selector-tag">section</span> &#123;<br>    <span class="hljs-attribute">position</span>: relative;<br>    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;<br>  &#125;<br>  <span class="hljs-selector-class">.section-dark</span> &#123;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#000</span>;<br>  &#125;<br>&#125;<br><span class="hljs-comment">// 第一屏</span><br><span class="hljs-selector-class">.section-hero</span> &#123;<br>&#125;<br><span class="hljs-comment">// 第三屏</span><br><span class="hljs-selector-class">.section-magic</span> &#123;<br>&#125;<br></code></pre></div></td></tr></table></figure>


<p>　　而每一屏特有的样式则在下面独立出来。</p>
<h1 id="首屏适配"><a href="#首屏适配" class="headerlink" title="首屏适配"></a>首屏适配</h1><p>　　首屏是整个网站的门面，体现出整个网站的特色与风格；我们看到首屏的设计还是比较简洁明了的，一个logo、主标题和slogan；随着屏幕宽度不断的缩放，文字的宽度和图片的大小也在随之缓慢的等比缩放，适配了各尺寸的屏幕。</p>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<p>　　缓慢的效果主要是通过<code>transition</code>属性来实现的，常见的用法是：<code>transition: 1s</code>表示过渡效果需要1秒来完成；这里我们发现后面还带有一个时间值：<code>transition: 1s 0.5s</code>；我们回顾一下transition的语法：</p>
<figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-attribute">transition</span>: property duration timing-function delay;<br></code></pre></div></td></tr></table></figure>

<p>　　不难猜出来1s表示完成时间duration，0.5s表示延迟时间delay；因此上面的就相当于下面的省略写法：</p>
<figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-attribute">transition</span>: all <span class="hljs-number">1s</span> ease <span class="hljs-number">0.5s</span><br></code></pre></div></td></tr></table></figure>
<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>

<p>　　不知道大家有没有遇到多个属性需要使用transition的情形，笔者一般会偷懒，使用all让它们的完成时间差不多；但是如果几个属性的完成时间差距较大，就需要使用逗号将多个属性复合使用：</p>
<figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss"><span class="hljs-selector-class">.box</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;<br>  <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;<br>  <span class="hljs-attribute">margin</span>: <span class="hljs-number">30px</span>;<br>  <span class="hljs-attribute">cursor</span>: pointer;<br>  <span class="hljs-attribute">transition</span>: width <span class="hljs-number">0.5s</span>, background-color <span class="hljs-number">1s</span> <span class="hljs-number">0.5s</span>, transform <span class="hljs-number">2s</span>;<br>  &amp;<span class="hljs-selector-pseudo">:hover</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: red;<br>    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">100px</span>);<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>　　通过transition属性我们能够实现很多意想不到的动画效果。</p>
<p><img src="/images/GSAP-Practise/transition.gif" srcset="/img/loading.gif" lazyload alt="复合transition属性"></p>
<p>　　我们发现在<code>.section-wrapper</code>外层还有一个比较特殊的类名，就是<code>.aspect-ratio</code>，这就涉及到了如何通过CSS来实现固定宽高比。</p>
<h2 id="CSS实现固定宽高比"><a href="#CSS实现固定宽高比" class="headerlink" title="CSS实现固定宽高比"></a>CSS实现固定宽高比</h2><p>　　首先，<code>可替换元素（replaced element）</code>实现固定宽高比就比较简单了，和其他元素不同，它们本身有像素宽度和高度的概念；这里说到了一个概念：可替换元素，其实就是浏览器根据元素的标签和属性，来决定元素的具体显示内容；可替换元素的内容不受当前文档的样式的影响。</p>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<blockquote>
<p>CSS可以影响可替换元素的位置，但不会影响到可替换元素自身的内容</p>
<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>
</blockquote>
<p>　　比如iframe也是可替换元素，可能有自己的样式表，CSS不能影响其内部的样式；常见的可替换元素有iframe、video、img、embed；与之相对应的就是不可替换元素了，它们内容可以受CSS渲染控制；我们常见的div、p、span等大多数都是不可替换元素。</p>
<p>　　我们就来看下img固定宽高比，只需要设置width或者height为一个具体值，另一个属性设置为auto即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;wrap&quot;&gt;<br>    &lt;img src=&quot;./images/1.jpg&quot; class=&quot;img&quot; /&gt; <br>  &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;style lang=&quot;scss&quot;&gt;<br>.wrap &#123;<br>  position: relative;<br>  width: 50vw;<br>  margin: 0 auto;<br>  .img &#123;<br>    width: 100%;<br>    height: auto;<br>  &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></div></td></tr></table></figure>

<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<p><img src="/images/GSAP-Practise/adaption.gif" srcset="/img/loading.gif" lazyload alt="img实现固定宽高比"></p>
<p>　　虽然上面的方式实现了可替换元素的固定宽高比，但是不适用于div、span等不可替换元素，因为它们本身是没有尺寸的，默认的高度都是0。</p>
<p>　　对于不可替换元素，我们能想到一种方式是通过js来实现，页面加载时获取宽度，根据宽高比rate计算出高度然后赋值style属性即可；别忘了，还需要监听resize，这样的方式也能实现。</p>
<p>　　另一种就是我们下面介绍的纯CSS的实现方式了，我们使用padding来撑大div的高度：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;wrap&quot;&gt;<br>    &lt;div class=&quot;cont&quot;&gt;&lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;style lang=&quot;scss&quot;&gt;<br>.wrap &#123;<br>  position: relative;<br>  width: 50vw;<br>  margin: 0 auto;<br>  .cont &#123;<br>    background-color: black;<br>    height: 0;<br>    padding: 0;<br>    padding-bottom: 75%;<br>  &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></div></td></tr></table></figure>

<p>　　我们看到div元素的宽高比也是固定的了，大致相当于4/3，也就是75%。</p>
<p><img src="/images/GSAP-Practise/padding.gif" srcset="/img/loading.gif" lazyload alt="div实现固定宽高比"></p>
<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>
<p>　　很多小伙伴肯定会好奇，为什么加了padding就能实现这样的效果；我们从mdn上来找答案，看下mdn对于padding属性的解释，当取百分比值的时候，是相当于包含块的宽度来计算的：</p>
<p><img src="/images/GSAP-Practise/mdn.png" srcset="/img/loading.gif" lazyload alt="mdn对于padding解释"></p>
<p>　　通过这种方式，div的高度实际上是被padding给撑开的；我们可以将上面的样式抽离成一个通用的样式<code>.aspect-ratio</code>；在需要用到固定宽高比的地方直接使用类名即可，给wrap元素设置一个padding-bottom样式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;wrap aspect-ratio&quot;&gt;<br>    &lt;div class=&quot;cont&quot;&gt;&lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;style lang=&quot;scss&quot;&gt;<br>// 抽离出来的公共样式<br>.aspect-ratio &#123;<br>  position: relative;<br>  &amp;::before &#123;<br>    display: block;<br>    content: &quot;&quot;;<br>  &#125;<br>  &amp; &gt; :first-child &#123;<br>    position: absolute;<br>    top: 0;<br>    left: 0;<br>    width: 100%;<br>    height: 100%;<br>  &#125;<br>&#125;<br>// 使用时给父级before加padding控制宽高比<br>.wrap &#123;<br>  position: relative;<br>  width: 50vw;<br>  margin: 0 auto;<br>  &amp;::before &#123;<br>    padding-bottom: 75%;<br>  &#125;<br>&#125;<br>.cont &#123;<br>  background-color: red;<br>&#125;<br>&lt;/style&gt;<br></code></pre></div></td></tr></table></figure>


<p>　　这样wrap盒子就被before元素撑开了，如果我们想要在里面放入内容，还需要将div内部元素使用绝对定位充满整个内容；这种方式虽然能够实现，但是只能高度随着宽度改变而改变，缺点是并不能反过来，宽度随着高度改变。</p>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<p>　　W3C提出一个保持纵横比的规范属性：aspect-ratio，我们看到目前大部分主流的浏览器也已经支持了，支持率已经有90%；但是IE还是全版本不支持，如果你不需要考虑支持IE，可以考虑使用该属性。</p>
<p><img src="/images/GSAP-Practise/aspect-ratio.png" srcset="/img/loading.gif" lazyload alt="aspect-ratio浏览器支持程度"></p>
<p>　　那么aspect-ratio如何使用呢？我们就不需要像上面的padding那样来套娃了，只需要在CSS添加一行代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;box&quot;&gt;&lt;/div&gt;<br>&lt;/template&gt;<br>&lt;style lang=&quot;scss&quot;&gt;<br>.box &#123;<br>  position: relative;<br>  width: 50vw;<br>  margin: 0 auto;<br>  // 直接添加宽高比<br>  aspect-ratio: 4 / 3;<br>  background-color: red;<br>&#125;<br>&lt;/style&gt;<br></code></pre></div></td></tr></table></figure>


<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>

<p>　　第二屏也是使用<code>.aspect-ratio</code>来实现视频元素宽高的固定比例，这里就不再赘述了。</p>
<h1 id="滚动渐显"><a href="#滚动渐显" class="headerlink" title="滚动渐显"></a>滚动渐显</h1><p>　　我们往下继续看，第三屏是滚动渐显的效果，这里就用到了GSAP的滚动触发，我们先欣赏一下页面的效果：</p>
<p><img src="/images/GSAP-Practise/fade-trigger.gif" srcset="/img/loading.gif" lazyload alt="滚动触发效果"></p>
<p>　　这一屏的页面布局也比较简单，一个section-headline标题，section-content内容包裹四个section-item模块展示。</p>
<figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-magic&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-wrapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-headline fade-copy fade-trigger&quot;</span>&gt;</span>4大技术加持 共筑新体验<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-content fade-copy fade-trigger&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-item&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-icon&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./images/icon-magic-ring.svg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-headline-reduced&quot;</span>&gt;</span>MagicRing 信任环<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-intro&quot;</span>&gt;</span>跨系统可信互联<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-item&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-icon&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./images/icon-magic-ring.svg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-headline-reduced&quot;</span>&gt;</span>Magic Live 智慧引擎<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;section-intro&quot;</span>&gt;</span>平台级AI能力<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 省略其他... --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span><br></code></pre></div></td></tr></table></figure>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>


<p>　　我们发现，这里<code>section-headline标题</code>和<code>section-content内容</code>都加了两个特殊的样式fade-copy和fade-trigger，fade-copy的样式比较简单，初始化通过<code>opacity: 0</code>进行隐藏，同时使用transform让它在原始位置Y轴偏下方；触发时，再加上active样式就可以实现从底部滑动上来，实现渐显的效果。</p>
<figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss"><span class="hljs-selector-class">.fade-copy</span> &#123;<br>  <span class="hljs-attribute">transition</span>: opacity <span class="hljs-number">0.5s</span>, transform <span class="hljs-number">0.5s</span>;<br>  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">50px</span>);<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>  &amp;<span class="hljs-selector-class">.active</span> &#123;<br>    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0px</span>);<br>    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>


<p>　　CSS的样式实现了，那么最最最关键的问题来了，如何在滚动时触发给fade-copy元素添加active类名呢？这里我们就用到了ScrollTrigger滚动触发了：</p>
<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">triggerFn</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> triggerList = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&quot;.fade-trigger&quot;</span>);<br>  triggerList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> hook = item.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&quot;data-hook&quot;</span>) || <span class="hljs-string">&quot;70%&quot;</span>;<br>    gsap.<span class="hljs-title function_">timeline</span>(&#123;<br>      <span class="hljs-attr">scrollTrigger</span>: &#123;<br>        <span class="hljs-attr">trigger</span>: item,<br>        <span class="hljs-attr">start</span>: <span class="hljs-string">&quot;top &quot;</span> + hook,<br>        <span class="hljs-attr">toggleClass</span>: <span class="hljs-string">&quot;active&quot;</span>,<br>        <span class="hljs-comment">// markers: true,</span><br>      &#125;,<br>    &#125;);<br>  &#125;);<br>&#125;;<br></code></pre></div></td></tr></table></figure>

<p>　　这里hook参数用来设置滚动触发起始的位置，默认是在距离屏幕顶部70%的高度；我们在写代码的时候，很多时候不知道元素滚动到什么时候会触发，因此可以给ScrollTrigger添加<code>markers: true</code>添加页面上的标记，来调试滚动条触发的位置；还不了解ScrollTrigger用法的小伙伴可以<a href="https://xieyufei.com/2023/02/06/GSAP-Learn.html#ScrollTrigger">点击这里</a>。</p>
<p>　　我们通过forEach循环来遍历页面上所有的<code>.fade-trigger</code>元素，每个元素都绑定了滚动触发的事件；因此在下面的很多地方，我们发现都是使用该类名来实现的效果。</p>
<h1 id="svg动画"><a href="#svg动画" class="headerlink" title="svg动画"></a>svg动画</h1><p>　　svg绘制的动画效果，图形可以进行无限缩放，也不会失真，相较于图片也更加的灵活；说到失真就不得不提<a target="_blank" rel="noopener" href="https://union-click.jd.com/jdc?e=618%7Cpc%7C&p=JF8BAM4JK1olXDYCVV9cDU8WC2cBGFglGVlaCgFtUQ5SQi0DBUVNGFJeSwUIFxlJX3EIGloUWAIDXFZUC0gIWipURmtUGhwKEBhZFitUfR8WGUVVDmNcNyYLBEcnAl8IGloWWQ4DV1paOHsXBF9edVsUXAcDVV9VCU4nAl8IHFIVXwEEU1dYDUgUM2gIEmtFD1JLHAltOHsUM2gIEk8TL0dQQFgvOHsXM2w4G1oVVA8LVlxYC0MLA20OElISQQYFXV5fD00QBmkNH1glXwcDUFdtOA">荣耀Magic5</a>的超动态臻彩显示技术，让HDR照片和视频栩栩如生，结合荣耀鹰眼精彩抓拍，让图像永不失真。</p>
<p>　　本文不对svg的具体使用教程进行深入的探讨，我们简单看下gsap是如何结合svg实现强大的动画效果。</p>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<p>　　在第四屏、十一屏、十五屏和十九屏都有类似的svg动画效果，我们以第四屏为例，首先欣赏一下页面的效果：</p>
<p><img src="/images/GSAP-Practise/ring.gif" srcset="/img/loading.gif" lazyload alt="滚动触发效果"></p>
<p>　　页面上通过前面三个ellipse元素绘制椭圆形描边，设置transform让每个旋转一定的角度，形成对称的图案；最后一个ellipse是中心的圆形。</p>
<figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">&quot;none&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;0 220% 0&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">ellipse</span></span><br><span class="hljs-tag">    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;magic-path&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">cx</span>=<span class="hljs-string">&quot;74.8447318&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">cy</span>=<span class="hljs-string">&quot;68.4&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">rx</span>=<span class="hljs-string">&quot;31.5406825&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">ry</span>=<span class="hljs-string">&quot;68.2132305&quot;</span></span><br><span class="hljs-tag">  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ellipse</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">ellipse</span></span><br><span class="hljs-tag">    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;magic-path&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">cx</span>=<span class="hljs-string">&quot;74.8447318&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">cy</span>=<span class="hljs-string">&quot;68.4&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">rx</span>=<span class="hljs-string">&quot;31.4542843&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">ry</span>=<span class="hljs-string">&quot;68.4&quot;</span></span><br><span class="hljs-tag">  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ellipse</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">ellipse</span></span><br><span class="hljs-tag">    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;magic-path&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">cx</span>=<span class="hljs-string">&quot;74.8447318&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">cy</span>=<span class="hljs-string">&quot;68.4&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">rx</span>=<span class="hljs-string">&quot;31.5406825&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">ry</span>=<span class="hljs-string">&quot;68.2132305&quot;</span></span><br><span class="hljs-tag">  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ellipse</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">ellipse</span></span><br><span class="hljs-tag">    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;magic-circle&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">fill</span>=<span class="hljs-string">&quot;#D7A85B&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">cx</span>=<span class="hljs-string">&quot;74.8447318&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">cy</span>=<span class="hljs-string">&quot;68.4&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">rx</span>=<span class="hljs-string">&quot;10.4847614&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">ry</span>=<span class="hljs-string">&quot;10.5230769&quot;</span></span><br><span class="hljs-tag">  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ellipse</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br></code></pre></div></td></tr></table></figure>

<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>

<p>　　图形绘制后，现在需要的就是如何让他们动起来，这里借助<code>stroke-dasharray</code>样式，让其实现描边的效果：</p>
<figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss">ellipse &#123;<br>  <span class="hljs-attribute">animation</span>: magic <span class="hljs-number">1.5s</span> linear;<br>  <span class="hljs-attribute">animation-fill-mode</span>: both;<br>  <span class="hljs-attribute">animation-delay</span>: <span class="hljs-number">3s</span>;<br>&#125;<br><span class="hljs-keyword">@keyframes</span> magic &#123;<br>  <span class="hljs-number">0%</span> &#123;<br>    stroke-dasharray: <span class="hljs-number">0</span> <span class="hljs-number">220%</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-number">100%</span> &#123;<br>    <span class="hljs-comment">// 如果写成220% 0% 0%就是顺时针</span><br>    stroke-dasharray: <span class="hljs-number">0%</span> <span class="hljs-number">0%</span> <span class="hljs-number">220%</span>;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>　　我们的图案就像下面一样动起来了：</p>
<p><img src="/images/GSAP-Practise/svg.gif" srcset="/img/loading.gif" lazyload alt="svg"></p>
<p>　　很多小伙伴对stroke-dasharray这个样式可能不是很了解，我们先看下mdn上的用法：</p>
<p><img src="/images/GSAP-Practise/stroke-dasharray.png" srcset="/img/loading.gif" lazyload alt="stroke-dasharray样式"></p>
<p>　　它是由数值或者百分比组成的一个数列，数列中的数值，第一个表示点的大小，第二值表示两个点之间的空隙大小；一般的写法如：<code>stroke-dasharray:10, 2</code>表示点10px，点空隙2px；上面样式中刚开始<code>0 220% 0</code>其实相当于<code>0 220%</code>，表示空隙占满全部的空间，也就是不显示了。</p>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<blockquote>
<p>使用stroke-dashoffset也能实现类似的效果。</p>
</blockquote>
<p>　　现在图案有了也动起来了，我们就不用CSS的动画了；我们需要结合GSAP来让它和滚动条实现互动了，还记得我们之前说过，GSAP也能控制svg的属性，让svg动起来么？</p>
<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">gsap<br>  .<span class="hljs-title function_">timeline</span>(&#123;<br>    <span class="hljs-attr">scrollTrigger</span>: &#123;<br>      <span class="hljs-attr">trigger</span>: <span class="hljs-string">&quot;.magic-svg&quot;</span>,<br>      <span class="hljs-attr">start</span>: <span class="hljs-string">&quot;top 60%&quot;</span>,<br>      <span class="hljs-attr">end</span>: <span class="hljs-string">&quot;bottom 100%&quot;</span>,<br>      <span class="hljs-attr">scrub</span>: <span class="hljs-number">0.5</span>,<br>    &#125;,<br>  &#125;)<br>  <span class="hljs-comment">// 让ellipse实现描边</span><br>  .<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;.magic-path&quot;</span>, &#123;<br>    <span class="hljs-attr">strokeDasharray</span>: <span class="hljs-string">&quot;0% 0% 220%&quot;</span>,<br>  &#125;)<br>  <span class="hljs-comment">// 让中心圆圈渐显</span><br>  .<span class="hljs-title function_">to</span>(<span class="hljs-string">&quot;.magic-circle&quot;</span>, &#123;<br>    <span class="hljs-attr">duration</span>: <span class="hljs-number">0.5</span>,<br>    <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>,<br>  &#125;)<br>  <span class="hljs-comment">// 让ellipse从细到粗渐变</span><br>  .<span class="hljs-title function_">from</span>(<br>    <span class="hljs-string">&quot;.magic-path&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">duration</span>: <span class="hljs-number">0.5</span>,<br>      <span class="hljs-attr">stroke</span>: <span class="hljs-string">&quot;#d7a85b&quot;</span>,<br>      <span class="hljs-attr">strokeWidth</span>: <span class="hljs-number">2</span>,<br>    &#125;,<br>    <span class="hljs-string">&quot;&lt;&quot;</span>,<br>  );<br></code></pre></div></td></tr></table></figure>


<p>　　我们发现，很多动画结束后，都有相同的效果，主标题headline渐隐展示、副标题subhead和链接link都从下方滚动展示出来；这里就需要介绍一个新的函数：<code>gsap.registerEffect</code>，可以让我们在全局注册想要的效果，直接调用，不用每次都重复造轮子。</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">gsap.<span class="hljs-title function_">registerPlugin</span>(<span class="hljs-title class_">SplitText</span>);<br><br><span class="hljs-comment">// 注册</span><br>gsap.<span class="hljs-title function_">registerEffect</span>(&#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;rainbow&quot;</span>,<br>  <span class="hljs-attr">effect</span>: <span class="hljs-function">(<span class="hljs-params">target, config</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">let</span> split = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SplitText</span>(target, &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;chars,words,lines&quot;</span> &#125;);<br>    <span class="hljs-keyword">return</span> gsap.<span class="hljs-title function_">from</span>(split.<span class="hljs-property">chars</span>, &#123; <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: -<span class="hljs-number">100</span>, <span class="hljs-attr">stagger</span>: <span class="hljs-number">0.05</span> &#125;);<br>  &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 初始化调用</span><br><span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  gsap.<span class="hljs-property">effects</span>.<span class="hljs-title function_">rainbow</span>(<span class="hljs-string">&quot;.h1&quot;</span>);<br>  gsap.<span class="hljs-property">effects</span>.<span class="hljs-title function_">rainbow</span>(<span class="hljs-string">&quot;.h2&quot;</span>);<br>&#125;);<br></code></pre></div></td></tr></table></figure>


<p><img src="/images/GSAP-Practise/rainbow.gif" srcset="/img/loading.gif" lazyload alt="registerEffect注册效果"></p>
<p>　　这样注册后我们每次都需要手动调用gsap.effects，或者我们还设置<code>extendTimeline: true</code>，在任意时间线之后都可以调用该效果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">gsap.<span class="hljs-title function_">registerEffect</span>(&#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;rainbow&quot;</span>,<br>  <span class="hljs-comment">// extendTimeline设置为true,可以直接在任何GSAP时间线上调用效果</span><br>  <span class="hljs-comment">// 让结果立即插入到定义的位置(默认是在最后的位置)</span><br>  <span class="hljs-attr">extendTimeline</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">// ...其他代码</span><br>&#125;);<br><br><span class="hljs-comment">// 调用</span><br><span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  gsap.<span class="hljs-title function_">timeline</span>()<br>    .<span class="hljs-title function_">rainbow</span>(<span class="hljs-string">&quot;.h1&quot;</span>)<br>    .<span class="hljs-title function_">rainbow</span>(<span class="hljs-string">&quot;.h2&quot;</span>);<br>&#125;);<br></code></pre></div></td></tr></table></figure>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>


<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>
<p>　　这样rainbow效果就会在时间线上顺序调用；我们回到荣耀的页面注册函数上来，发现在全局注册了一个tech4的效果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">gsap.<span class="hljs-title function_">registerEffect</span>(&#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;tech4&quot;</span>,<br>  <span class="hljs-attr">extendTimeline</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">effect</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">targets</span>) &#123;<br>    <span class="hljs-keyword">let</span> tl = gsap<br>      .<span class="hljs-title function_">timeline</span>()<br>      <span class="hljs-comment">// 整个svg从放大效果回到正常</span><br>      .<span class="hljs-title function_">from</span>(targets[<span class="hljs-number">0</span>], &#123;<br>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0.5</span>,<br>        <span class="hljs-attr">scale</span>: <span class="hljs-number">5</span>,<br>        <span class="hljs-attr">yPercent</span>: <span class="hljs-number">80</span>,<br>      &#125;)<br>      <span class="hljs-comment">// 标题逐渐显示</span><br>      .<span class="hljs-title function_">to</span>(targets[<span class="hljs-number">1</span>], &#123;<br>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0.5</span>,<br>        <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>,<br>      &#125;)<br>      <span class="hljs-comment">// 副标题从下向上滚动</span><br>      .<span class="hljs-title function_">fromTo</span>(<br>        targets[<span class="hljs-number">2</span>],<br>        &#123;<br>          <span class="hljs-attr">y</span>: <span class="hljs-number">60</span>,<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,<br>          <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>,<br>        &#125;,<br>      );<br>    <span class="hljs-comment">// link链接从下向上滚动</span><br>    <span class="hljs-keyword">if</span> (targets[<span class="hljs-number">3</span>]) &#123;<br>      tl.<span class="hljs-title function_">fromTo</span>(<br>        targets[<span class="hljs-number">3</span>],<br>        &#123;<br>          <span class="hljs-attr">y</span>: <span class="hljs-number">60</span>,<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,<br>          <span class="hljs-attr">autoAlpha</span>: <span class="hljs-number">1</span>,<br>        &#125;,<br>      );<br>    &#125;<br>    <span class="hljs-keyword">return</span> tl;<br>  &#125;,<br>&#125;);<br></code></pre></div></td></tr></table></figure>


<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<p>　　因此在动画效果结束后，都会调用这个<code>tech4</code>效果来对标题、副标题等元素进行处理。</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">gsap<br>  .<span class="hljs-title function_">timeline</span>()<br>  <span class="hljs-comment">// 其他的效果</span><br>  .<span class="hljs-title function_">tech4</span>([svg, headline, subhead, link, wrapper], <span class="hljs-string">&quot;&lt;&quot;</span>);<br></code></pre></div></td></tr></table></figure>



<h1 id="卡片式布局"><a href="#卡片式布局" class="headerlink" title="卡片式布局"></a>卡片式布局</h1><p>　　我们前面介绍过卡片式布局的通用样式是<code>.section-card-view</code>，这种布局将两个或多个div如同卡片横向排列，随着滚动条而移动，首先也来欣赏一下页面的滚动效果：</p>
<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>
<p><img src="/images/GSAP-Practise/card.gif" srcset="/img/loading.gif" lazyload alt="卡片式布局效果"></p>
<p>　　页面结构看似很复杂，其实主要就三层结构：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;section class=&quot;section-connect-4 section-card-view&quot;&gt;<br>    &lt;div class=&quot;sticky-wrapper&quot;&gt;<br>      &lt;div class=&quot;sticky-content&quot;&gt;<br>        &lt;div class=&quot;section-wrapper&quot;&gt;<br>          &lt;div class=&quot;section-card&quot;&gt; &lt;!-- 卡片内容--&gt; &lt;/div&gt;<br>          &lt;div class=&quot;section-card&quot;&gt; &lt;!-- 卡片内容--&gt; &lt;/div&gt;<br>        &lt;/div&gt;<br>      &lt;/div&gt;<br>    &lt;/div&gt;<br>  &lt;/section&gt;<br>&lt;/template&gt;<br>&lt;style lang=&quot;scss&quot;&gt;<br>.section-card-view &#123;<br>  .sticky-wrapper &#123;<br>    height: 108.333333vw;<br>  &#125;<br>  .sticky-content &#123;<br>    position: sticky;<br>    width: 100%;<br>    height: auto;<br>    top: 65px;<br>    overflow: hidden;<br>  &#125;<br>  .section-wrapper &#123;<br>    position: relative;<br>    display: flex;<br>    width: 70.833333vw;<br>    margin: 0 auto;<br>  &#125;<br>  .section-card &#123;<br>    position: relative;<br>    flex-shrink: 0;<br>    width: 100%;<br>  &#125;<br>  .section-card + .section-card &#123;<br>    margin-left: 3.125vw;<br>  &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></div></td></tr></table></figure>


<p>　　我们仔细来看下它的层级结构，首先是<code>.sticky-wrapper</code>设置高度108vw，用来撑开高度；中间的元素<code>.sticky-content</code>设置position:sticky，就是我们用来实现粘性定位的主要元素了，这样页面在滚动时就能保证内容始终距离顶部悬浮一定高度；<code>.section-wrapper</code>设置display:flex，是内部flex布局的容器。</p>
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<p>　　我们发现第二个元素刚开始会有缩小并且毛玻璃的效果，弱化内容的展示，随着滚动逐渐清晰；初始化时可以通过css设置blur，来达到毛玻璃的遮罩效果。</p>
<figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.section-card</span> + <span class="hljs-selector-class">.section-card</span> <span class="hljs-selector-class">.section-card-content</span> &#123;<br>  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">0.8</span>);<br>  <span class="hljs-attribute">transform-origin</span>: left;<br>  <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">10px</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure>


<p>　　页面有了，那如果让卡片滚动起来呢？又到了我们的GSAP开始大显身手的时候了；实现的逻辑其实也非常简单，粘性定位元素<code>.sticky-content</code>在滚动时保持悬浮位置不变，让其内部的flex布局元素<code>.section-wrapper</code>向右移动，这样就让我们有种错觉，滚动条向下时将卡片推着移动。</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">cardViewFn</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> sections = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&quot;.section-card-view&quot;</span>);<br><br>  sections.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">section</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> wrapper = section.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.section-wrapper&quot;</span>);<br>    <span class="hljs-keyword">const</span> stickyWrapper = section.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.sticky-wrapper&quot;</span>);<br><br>    gsap.<span class="hljs-title function_">to</span>(wrapper, &#123;<br>      <span class="hljs-attr">scrollTrigger</span>: &#123;<br>        <span class="hljs-attr">trigger</span>: stickyWrapper,<br>        <span class="hljs-attr">start</span>: <span class="hljs-string">&quot;top 65&quot;</span>,<br>        <span class="hljs-attr">end</span>: <span class="hljs-string">&quot;bottom 100%&quot;</span>,<br>        <span class="hljs-attr">scrub</span>: <span class="hljs-number">0</span>,<br>      &#125;,<br>      <span class="hljs-attr">ease</span>: <span class="hljs-string">&quot;none&quot;</span>,<br>      <span class="hljs-attr">x</span>: -swiperOffset,<br>    &#125;);<br>  &#125;)<br>&#125;<br></code></pre></div></td></tr></table></figure>


<p>　　我们查找页面上所有的<code>.section-card-view</code>，遍历元素将其绑定ScrollTrigger事件；scrub属性将滚动条和<code>.sticky-wrapper</code>元素的x轴位移绑定；其实现的效果如下：</p>
<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>
<p><img src="/images/GSAP-Practise/sticky.gif" srcset="/img/loading.gif" lazyload alt="滚动位移"></p>
<p>　　我们看到上面的代码中有一个<code>swiperOffset</code>变量，猜测就是wrapper的位移距离，那它是如何来计算的呢？我们将整个flex布局元素<code>.section-wrapper</code>内部的所有卡片想象成一个整体的div，它向左移动的距离就是整体的宽度减去页面的宽度，因此我们主要的工作就是计算它的宽度。</p>
<p><img src="/images/GSAP-Practise/move.png" srcset="/img/loading.gif" lazyload alt="位移距离"></p>
<p>　　计算方式直接上代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> screenWidth = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientWidth</span>;<br><span class="hljs-keyword">const</span> cardWidth = cards[<span class="hljs-number">0</span>].<span class="hljs-property">clientWidth</span>;<br><span class="hljs-keyword">const</span> cardMargin = <span class="hljs-title class_">Number</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(cards[<span class="hljs-number">1</span>]).<span class="hljs-title function_">getPropertyValue</span>(<span class="hljs-string">&quot;margin-left&quot;</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">2</span>));<br><span class="hljs-keyword">const</span> cardsNumber = cards.<span class="hljs-property">length</span>;<br><br><span class="hljs-keyword">const</span> swiperOffset =<br>  <span class="hljs-comment">// 距离页面左侧的宽度 * 2</span><br>  wrapper.<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">left</span> * <span class="hljs-number">2</span> <br>  <span class="hljs-comment">// 每个卡片宽度 * 卡片数量</span><br>  + cardWidth * cardsNumber<br>  <span class="hljs-comment">// 卡片的左侧距离 * (卡片数量 - 1)</span><br>  + cardMargin * (cardsNumber - <span class="hljs-number">1</span>) <br>  <span class="hljs-comment">// 屏幕的宽度</span><br>  - screenWidth;<br><br>gsap.<span class="hljs-title function_">to</span>(wrapper, &#123;<br>  <span class="hljs-comment">// 省略其他代码</span><br>  <span class="hljs-attr">x</span>: -swiperOffset,<br>&#125;);<br></code></pre></div></td></tr></table></figure>


<p>　　那么现在wrapper也滚动起来了，我们就需要将第二个及其以后的卡片内容在滚动时逐渐放大清晰，去掉模糊效果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> cardScroll = cardWidth + cardMargin;<br><span class="hljs-keyword">const</span> stickyTop = <span class="hljs-number">65</span>;<br><br>cards.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">card, index</span>) &#123;<br>  <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">const</span> startTrigger = stickyTop - cardScroll * (index - <span class="hljs-number">1</span>);<br><br>    gsap.<span class="hljs-title function_">to</span>(card.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.section-card-content&quot;</span>), &#123;<br>      <span class="hljs-attr">scrollTrigger</span>: &#123;<br>        <span class="hljs-attr">trigger</span>: card,<br>        <span class="hljs-attr">start</span>: <span class="hljs-string">&quot;top &quot;</span> + startTrigger,<br>        <span class="hljs-attr">end</span>: <span class="hljs-string">&quot;+=&quot;</span> + cardScroll / <span class="hljs-number">3</span>,<br>        <span class="hljs-attr">scrub</span>: <span class="hljs-number">0</span>,<br>      &#125;,<br>      <span class="hljs-attr">ease</span>: <span class="hljs-string">&quot;none&quot;</span>,<br>      <span class="hljs-attr">filter</span>: <span class="hljs-string">&quot;blur(0px)&quot;</span>,<br>      <span class="hljs-attr">scale</span>: <span class="hljs-number">1</span>,<br>    &#125;);<br>  &#125;<br>&#125;);<br></code></pre></div></td></tr></table></figure>

<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p>
<p>　　最终实现的效果如下：</p>
<p><img src="/images/GSAP-Practise/sticky1.gif" srcset="/img/loading.gif" lazyload alt="实现效果"></p>
<p>　　滚动效果丝滑的如同<a target="_blank" rel="noopener" href="https://union-click.jd.com/jdc?e=618%7Cpc%7C&p=JF8BAM4JK1olXDYCVV9cDU8WC2cBGFglGVlaCgFtUQ5SQi0DBUVNGFJeSwUIFxlJX3EIGloUWAIDXFZUC0gIWipURmtUGhwKEBhZFitUfR8WGUVVDmNcNyYLBEcnAl8IGloWWQ4DV1paOHsXBF9edVsUXAcDVV9VCU4nAl8IHFIVXwEEU1dYDUgUM2gIEmtFD1JLHAltOHsUM2gIEk8TL0dQQFgvOHsXM2w4G1oVVA8LVlxYC0MLA20OElISQQYFXV5fD00QBmkNH1glXwcDUFdtOA">荣耀Magic5</a>的悬浮流线四曲面屏一样，无界视域，自在掌控。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>　　通过本文，我们结合实际的案例，对GSAP的使用方式有了更进一步的了解；但是由于篇幅和精力的限制，本文主要分析了滚动渐显、svg动画和卡片式布局的几个效果，实际页面中有非常丰富的效果，本文只是窥探了其中的极少一部分的效果，大家如果感兴趣可以自行在荣耀官网查看。</p>
<blockquote>
<p>本文所有源码敬请关注公众号【前端壹读】，后台回复关键词【GASP荣耀官网】即可获取。</p>
</blockquote>
<img src="/images/qrcode.png" srcset="/img/loading.gif" lazyload alt="" align="center" width="40%" style="display:block;margin:0 auto;"/>
<script>if(window.location.hostname.indexOf("xieyufei.com") === -1){ window.location.href = "https://xieyufei.com" }</script>
            </div>
            <hr>
            <div>
              
<p><a class="prevent_reptile" href="https://www.xieyufei.com" style="font-size:24px" target="_blank" rel="noopener">谢小飞博客专用防爬虫链接，想要看最新的前端博客请点这里</a></p><div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/programing/">编程</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/FrontEnd/">前端</a>
                    
                      <a class="hover-with-bg" href="/tags/Animation/">动画</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本网所有内容文字和图片，版权均属谢小飞所有，任何媒体、网站或个人未经本网协议授权不得转载、链接、转贴或以其他方式复制发布/发表。如需转载请关注公众号【前端壹读】后回复【转载】。
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/04/28/Threejs-Panorama.html">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">一文掌握你所需Threejs3D全景预览</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/03/07/Whatis-Chatgpt.html">
                        <span class="hidden-mobile">ChatGPT的狂飙之路</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createScript('https://xieyufei.com/npm/waline@1.6.0/Waline.min.js', function() {
        var options = Object.assign(
          {"serverURL":"https://comment.xieyufei.com","placeholder":"说点什么","path":"window.location.pathname","avatar":"retro","meta":["nick","mail","link"],"pageSize":10,"lang":"zh-CN","highlight":true,"avatarCDN":"","avatarForce":false,"requiredFields":[],"emojiCDN":null,"emojiMaps":null,"anonymous":null,"appId":"dUHCmA1MmCKBNcTMG9KBopvL-MdYXbMMI","appKey":"33GvkVfTefXyelQRBTXNgEn6"},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        new Waline(options);
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="javascript:; target="_blank" rel="nofollow noopener"><span>We</span></a> <i class="iconfont icon-love"></i> <a href="https://xieyufei.com" target="_blank" rel="nofollow noopener"><span>谢小飞</span></a> <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> 
  </div>
  

  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        苏ICP备2024128889号-1
      </a>
    </span>
    
  </div>


  
    <!-- cnzz Analytics Icon -->
    <span id="cnzz_stat_icon_1260607518" style="display: none"></span>
  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://xieyufei.com/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://xieyufei.com/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://xieyufei.com/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://xieyufei.com/npm/bootstrap/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://xieyufei.com/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://xieyufei.com/npm/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://xieyufei.com/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://xieyufei.com/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>






  <script  src="https://xieyufei.com/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?466240fe55764d8ee20bd7f43c5e8b26";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  
    <!-- cnzz Analytics -->
    <script defer src="//s4.cnzz.com/z_stat.php?id=1260607518&show=pic"
            type="text/javascript"></script>
  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
